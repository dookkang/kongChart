<?php require $_SERVER["DOCUMENT_ROOT"]."/php/etc/inc.php"; ?>
<?php require $_SERVER["DOCUMENT_ROOT"]."/php/etc/dbConnect.php"; ?>
<html>
<head>
	<title>자 유 게 시 판</title>
	<?php require $_SERVER["DOCUMENT_ROOT"]."/php/etc/meta.php"; ?>
</head>
<body topmargin=0 leftmargin=0 text=#464646>
<center>
<br>
<font size=2> 자 유 게 시 판
<br>
<br>
<table width=80% border=0 cellpadding=2 cellspacing=1 bgcolor=#777777>
	<tr height=20 bgcolor=#999999>
		<td width=10% align=center style='color:white'>
			번호
		</td>
		<td align=center style='color:white'>
			제목
		</td>
		<td width=10% align=center style='color:white'>
			글쓴이
		</td>
		<td width=20% align=center style='color:white'>
			날짜
		</td>
		<td width=10% align=center style='color:white'>
			조회수
		</td>
	</tr>
<?php
	$cnt = 0;
	$cntquery = "SELECT count(*) as 'cnt' FROM `T_BD_CUS` WHERE 1";
	$cntresult = mysql_query($cntquery, $conn);
	while($cntrow = mysql_fetch_array($cntresult))
	{
		$cnt = $cntrow[cnt];
	}
	

?>
	
<?php
	$cr = 0;
	$cquery = "SELECT ceil(count(*)/15) as 'co' FROM `T_BD_CUS` WHERE 1";
	$cresult = mysql_query($cquery, $conn);
	while($crow = mysql_fetch_array($cresult))
	{
		$cr = $crow[co];
	}

?>


	
<?php
	$pageNum = $_REQUEST[pageNum];
	if(is_null($pageNum)){
		$pageNum = 1;
	};
	$list = 15;
	$b_pageNum_list = 10;
	$block = ceil($pageNum/$b_pageNum_list);
	$b_start_page = ( ($block - 1) * $b_pageNum_list ) + 1; 
	$b_end_page = $b_start_page + $b_pageNum_list - 1; 

	$from = ($pageNum-1)*$list;
	$query = "select * from T_BD_CUS order by wdate desc limit $from,$list ";
	$result = mysql_query($query, $conn);

	print $block;
	
	$Acount = 0;
	$Acountquery = "SELECT count(*) as 'Acount' FROM `T_BD_CUS` WHERE 1";
	$Acountresult = mysql_query($Acountquery, $conn);
	while($Acountrow = mysql_fetch_array($Acountresult))
	{
		$Acount = $Acountrow[Acount];
	}

	$count = mysql_num_rows($result);
	$num = $count;
	$total_page = ceil( $Acount / $list );
	if ($b_end_page > $total_page){ 

	$b_end_page = $total_page;
	};

	$n = 0;
	$nnn = $cnt-(($pageNum-1)*$list);
	while($row = mysql_fetch_array($result))
	{
	
?>
	<tr>
		<td height=20 bgcolor=white name="id" align='center'>
		<?php print $nnn--;?>
		</td>
		<td height=20 bgcolor=white align=left>
		<a href="/php/board/read.html?id=<?php print $row[id];?>"><?php print $row[title];?></a>
		</td>
		<td height=20 bgcolor=white align=center>
		<?php print $row[name];?>
		</td>
		<td height=20 bgcolor=white align=center>
		<?php print $row[wdate];?>
		</td>
		<td height=20 bgcolor=white align=center>
		<?php print $row[view];?>
		</td>
	</tr>
<?php
	$n++;
	$num--;
  }

	
?>
			
</table>




<?php
	mysql_close($conn);
?>
<br>
<?php
if($block <=1){  //block이 1보다 작거나 같으면 ?>

	<font> </font> <?//더 이상 거꾸로 갈 수 없으므로 아무 표시도 하지 않습니다.

}else{ //block이 1보다 크다면?>

	<font size=2><a href="/php/board/list.html?pageNum=<?=$b_start_page-1?>&list=<?=$list?>&cc=<?=$b_start_page-10?>">이전</a></font>

<?//이전 링크를 보여줍니다.

	}





	$cc = $_REQUEST[cc];
	if(is_null($cc)){
		$cc = 1;
	};
	$cc = 1+((10*$block)-10);
	for(; $cc <=$b_end_page ; $cc++){
?>
	<a href="/php/board/list.html?pageNum=<?php print $cc;?>"><?php print '&nbsp;'.$cc.'&nbsp;';?></a>
<?php	
	};




$total_block = ceil($total_page/$b_pageNum_list);

if($block >= $total_block){  //block 과 총 block 갯수와 값이 같다면?>

	<font> </font>  <?// 맨 마지막 블럭이므로 다음링크버튼이 필요없어서 보여주지 않는다.

}else{ //그게 아니라면?>

        <font size=2><a href="/php/board/list.html?pageNum=<?=$b_end_page+1?>&list=<?=$list?>&cc=<?=$cc?>">다음</a></font>

<?//다음 링크버튼을 걸어 보여준다.

}

?>


	<br>
	<br>
	<a href="/php/board/write.html">글쓰기</a>



</center>
</body>
</html>